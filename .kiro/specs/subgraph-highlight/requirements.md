# 子图高亮功能需求文档

## 介绍

在智能图表生成器的第3步正式图纸阶段，添加子图高亮功能。该功能允许用户通过搜索选择特定节点，然后高亮显示与该节点直接关联的所有节点和边，形成一个子图视图，帮助用户专注于特定的业务流程片段。

## 需求

### 需求1：子图搜索界面

**用户故事：** 作为用户，我希望能够通过专门的搜索框搜索节点来创建子图高亮，以便我能够专注于特定的业务流程片段。

#### 验收标准

1. WHEN 用户在正式图纸阶段 THEN 系统应显示两个独立的搜索框
2. WHEN 用户查看搜索区域 THEN 第一个搜索框应标记为"搜索节点（本体）"用于原有的节点搜索功能
3. WHEN 用户查看搜索区域 THEN 第二个搜索框应标记为"子图高亮搜索"用于新的子图功能
4. WHEN 用户在子图搜索框中输入关键词 THEN 系统应实时显示匹配的节点列表
5. WHEN 搜索结果为空 THEN 系统应显示"未找到匹配节点"的提示信息

### 需求2：节点选择和子图计算

**用户故事：** 作为用户，我希望能够从搜索结果中选择特定节点，系统自动计算并显示与该节点直接关联的子图，以便我能够清晰地看到相关的业务流程。

#### 验收标准

1. WHEN 用户在子图搜索框中搜索 THEN 系统应显示包含搜索关键词的节点列表
2. WHEN 用户点击搜索结果中的某个节点 THEN 系统应计算该节点的直接关联关系
3. WHEN 系统计算子图 THEN 应包括选中节点本身
4. WHEN 系统计算子图 THEN 应包括所有与选中节点直接相连的节点（通过边连接）
5. WHEN 系统计算子图 THEN 应包括连接这些节点的所有边
6. WHEN 子图计算完成 THEN 系统应高亮显示所有子图中的节点和边
7. WHEN 子图高亮激活 THEN 非子图的节点和边应保持正常显示但视觉上变淡

### 需求3：子图高亮显示效果

**用户故事：** 作为用户，我希望子图高亮效果清晰明显且持续显示，以便我能够持续专注于相关的业务流程而不被其他元素干扰。

#### 验收标准

1. WHEN 子图高亮激活 THEN 子图中的节点应使用特殊的高亮样式（如蓝色脉冲动画）
2. WHEN 子图高亮激活 THEN 子图中的边应使用特殊的高亮样式（如加粗和颜色变化）
3. WHEN 子图高亮激活 THEN 非子图的节点应降低透明度至50%
4. WHEN 子图高亮激活 THEN 非子图的边应降低透明度至30%
5. WHEN 子图高亮激活 THEN 高亮状态应持续保持直到用户主动取消
6. WHEN 用户进行其他操作（如拖拽节点）THEN 子图高亮状态应保持不变

### 需求4：整体概览功能

**用户故事：** 作为用户，我希望能够方便地回到整体图表视图并清除所有高亮效果，以便我能够重新查看完整的业务流程图。

#### 验收标准

1. WHEN 子图高亮激活时 THEN 系统应显示"回到整体概览"按钮
2. WHEN 没有子图高亮时 THEN "回到整体概览"按钮应隐藏或禁用
3. WHEN 用户点击"回到整体概览"按钮 THEN 系统应清除所有子图高亮效果
4. WHEN 用户点击"回到整体概览"按钮 THEN 系统应将整个图表适应画布并居中显示
5. WHEN 整体概览激活 THEN 所有节点和边应恢复正常的透明度和样式
6. WHEN 整体概览激活 THEN 子图搜索框应清空内容

### 需求5：功能兼容性

**用户故事：** 作为用户，我希望新的子图高亮功能与现有的节点搜索功能能够独立工作，以便我能够根据需要使用不同的搜索方式。

#### 验收标准

1. WHEN 用户使用原有的节点搜索功能 THEN 子图高亮状态应被清除
2. WHEN 用户使用子图高亮功能 THEN 原有的节点搜索高亮应被清除
3. WHEN 两个搜索功能同时存在 THEN 它们应该在视觉上明确区分
4. WHEN 用户在两个搜索框之间切换 THEN 系统应正确处理状态转换
5. WHEN 页面刷新或重新加载 THEN 所有搜索和高亮状态应重置

### 需求6：用户体验优化

**用户故事：** 作为用户，我希望子图高亮功能操作简单直观，响应迅速，以便我能够高效地分析业务流程图。

#### 验收标准

1. WHEN 用户进行子图搜索 THEN 搜索响应时间应小于500毫秒
2. WHEN 用户选择节点创建子图 THEN 高亮效果应在200毫秒内显示
3. WHEN 子图包含大量节点（>20个）THEN 系统应提供性能优化确保流畅操作
4. WHEN 用户操作过程中 THEN 应提供适当的加载指示器和状态反馈
5. WHEN 子图高亮激活 THEN 应显示子图统计信息（如"已选中X个节点，Y条边"）
6. WHEN 用户hover子图中的元素 THEN 应提供额外的视觉反馈